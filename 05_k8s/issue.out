node71.lab.local
 [WARNING]: Could not match supplied host pattern, ignoring: newhost


PLAY [localhost] **********************************************************************************************************************************************

TASK [Set global variables] ***********************************************************************************************************************************
ok: [localhost]

TASK [Set ip] *************************************************************************************************************************************************
ok: [localhost]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [localhost]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [localhost]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [localhost]

TASK [Create ansible group for new hosts] *********************************************************************************************************************
changed: [localhost]

TASK [Delete ssh keys for template] ***************************************************************************************************************************
 [WARNING]: Consider using the replace, lineinfile or template module rather than running 'sed'.  If you need to use command because replace, lineinfile or
template is insufficient you can add 'warn: false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [localhost]

TASK [Delete ssh keys for ip] *********************************************************************************************************************************
changed: [localhost]

TASK [Create ansible group for ipa server] ********************************************************************************************************************
changed: [localhost]

TASK [Create data directory] **********************************************************************************************************************************
 [WARNING]: Consider using the file module with state=directory rather than running 'mkdir'.  If you need to use command because file is insufficient you can
add 'warn: false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [localhost]

TASK [Clone template] *****************************************************************************************************************************************
changed: [localhost]

TASK [Set max memory] *****************************************************************************************************************************************
changed: [localhost]

TASK [Set more memory] ****************************************************************************************************************************************
changed: [localhost]

TASK [Start machine] ******************************************************************************************************************************************
changed: [localhost]

PLAY [centos7] ************************************************************************************************************************************************

TASK [pause] **************************************************************************************************************************************************
Pausing for 25 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [centos7]

TASK [Set global variables] ***********************************************************************************************************************************
ok: [centos7]

TASK [Set ip] *************************************************************************************************************************************************
ok: [centos7]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [centos7]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [centos7]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [centos7]

TASK [Change hostname] ****************************************************************************************************************************************
changed: [centos7]

TASK [Add hosts to hostname] **********************************************************************************************************************************
changed: [centos7]

TASK [Resize partition] ***************************************************************************************************************************************
fatal: [centos7]: FAILED! => {"changed": true, "cmd": "printf 'd\\n2\\np\\nn\\np\\n2\\n\\n\\nt\\n2\\n8e\\nw' | fdisk /dev/sda", "delta": "0:00:00.123351", "end": "2020-01-11 12:17:45.482990", "msg": "non-zero return code", "rc": 1, "start": "2020-01-11 12:17:45.359639", "stderr": "", "stderr_lines": [], "stdout": "Welcome to fdisk (util-linux 2.23.2).\n\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): Partition number (1,2, default 2): Partition 2 is deleted\n\nCommand (m for help): \nDisk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0x00013b86\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *        2048     2099199     1048576   83  Linux\n\nCommand (m for help): Partition type:\n   p   primary (1 primary, 0 extended, 3 free)\n   e   extended\nSelect (default p): Partition number (2-4, default 2): First sector (2099200-41943039, default 2099200): Using default value 2099200\nLast sector, +sectors or +size{K,M,G} (2099200-41943039, default 41943039): Using default value 41943039\nPartition 2 of type Linux and of size 19 GiB is set\n\nCommand (m for help): Partition number (1,2, default 2): Hex code (type L to list all codes): Changed type of partition 'Linux' to 'Linux LVM'\n\nCommand (m for help): The partition table has been altered!\n\nCalling ioctl() to re-read partition table.\n\nWARNING: Re-reading the partition table failed with error 16: Device or resource busy.\nThe kernel still uses the old table. The new table will be used at\nthe next reboot or after you run partprobe(8) or kpartx(8)\nSyncing disks.", "stdout_lines": ["Welcome to fdisk (util-linux 2.23.2).", "", "Changes will remain in memory only, until you decide to write them.", "Be careful before using the write command.", "", "", "Command (m for help): Partition number (1,2, default 2): Partition 2 is deleted", "", "Command (m for help): ", "Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors", "Units = sectors of 1 * 512 = 512 bytes", "Sector size (logical/physical): 512 bytes / 512 bytes", "I/O size (minimum/optimal): 512 bytes / 512 bytes", "Disk label type: dos", "Disk identifier: 0x00013b86", "", "   Device Boot      Start         End      Blocks   Id  System", "/dev/sda1   *        2048     2099199     1048576   83  Linux", "", "Command (m for help): Partition type:", "   p   primary (1 primary, 0 extended, 3 free)", "   e   extended", "Select (default p): Partition number (2-4, default 2): First sector (2099200-41943039, default 2099200): Using default value 2099200", "Last sector, +sectors or +size{K,M,G} (2099200-41943039, default 41943039): Using default value 41943039", "Partition 2 of type Linux and of size 19 GiB is set", "", "Command (m for help): Partition number (1,2, default 2): Hex code (type L to list all codes): Changed type of partition 'Linux' to 'Linux LVM'", "", "Command (m for help): The partition table has been altered!", "", "Calling ioctl() to re-read partition table.", "", "WARNING: Re-reading the partition table failed with error 16: Device or resource busy.", "The kernel still uses the old table. The new table will be used at", "the next reboot or after you run partprobe(8) or kpartx(8)", "Syncing disks."]}
...ignoring

TASK [Partprobe disks] ****************************************************************************************************************************************
changed: [centos7]

TASK [PV resize] **********************************************************************************************************************************************
changed: [centos7]

TASK [Add an Ethernet connection with static IP configuration] ************************************************************************************************
changed: [centos7]

TASK [Install additional packages] ****************************************************************************************************************************
 [WARNING]: Consider using the yum module rather than running 'yum'.  If you need to use command because yum is insufficient you can add 'warn: false' to this
command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [centos7]

TASK [Enable make dir option for new users] *******************************************************************************************************************
changed: [centos7]

TASK [Update sshd config - part 1] ****************************************************************************************************************************
changed: [centos7]

TASK [Update sshd config - part 2] ****************************************************************************************************************************
changed: [centos7]

TASK [Update ssh config - non strict host checking] ***********************************************************************************************************
changed: [centos7]

PLAY [localhost] **********************************************************************************************************************************************

TASK [Shutdown host] ******************************************************************************************************************************************
changed: [localhost]

TASK [pause] **************************************************************************************************************************************************
Pausing for 5 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [localhost]

TASK [Destroy domain] *****************************************************************************************************************************************
fatal: [localhost]: FAILED! => {"changed": true, "cmd": "virsh destroy node71.lab.local", "delta": "0:00:00.057427", "end": "2020-01-11 18:19:16.130608", "msg": "non-zero return code", "rc": 1, "start": "2020-01-11 18:19:16.073181", "stderr": "error: Failed to destroy domain node71.lab.local\nerror: Requested operation is not valid: domain is not running", "stderr_lines": ["error: Failed to destroy domain node71.lab.local", "error: Requested operation is not valid: domain is not running"], "stdout": "", "stdout_lines": []}
...ignoring

TASK [Change virbr interface] *********************************************************************************************************************************
changed: [localhost]

TASK [Start domain] *******************************************************************************************************************************************
changed: [localhost]

PLAY [newhost] ************************************************************************************************************************************************

TASK [pause] **************************************************************************************************************************************************
Pausing for 25 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [10.1.16.71]

TASK [Set global variables] ***********************************************************************************************************************************
ok: [10.1.16.71]

TASK [Set ip] *************************************************************************************************************************************************
ok: [10.1.16.71]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [10.1.16.71]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [10.1.16.71]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [10.1.16.71]

TASK [Join machine to IPA domain] *****************************************************************************************************************************
changed: [10.1.16.71]

PLAY RECAP ****************************************************************************************************************************************************
10.1.16.71                 : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
centos7                    : ok=17   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=1   
localhost                  : ok=19   changed=13   unreachable=0    failed=0    skipped=0    rescued=0    ignored=1   

 [WARNING]: Could not match supplied host pattern, ignoring: master


PLAY [localhost] **********************************************************************************************************************************************

TASK [Set global variables] ***********************************************************************************************************************************
ok: [localhost]

TASK [Set ip] *************************************************************************************************************************************************
ok: [localhost]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [localhost]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [localhost]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [localhost]

TASK [Create ansible group for new hosts] *********************************************************************************************************************
changed: [localhost]

PLAY [master] *************************************************************************************************************************************************

TASK [Set global variables] ***********************************************************************************************************************************
ok: [node71.lab.local]

TASK [Set ip] *************************************************************************************************************************************************
ok: [node71.lab.local]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [node71.lab.local]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [node71.lab.local]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [node71.lab.local]

TASK [Disable SElinux] ****************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Disable swap] *******************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Setup firewall rules] ***********************************************************************************************************************************
changed: [node71.lab.local]

TASK [Open BGP protocal on firewalld] *************************************************************************************************************************
changed: [node71.lab.local]

TASK [Setup masquarade and reload rules] **********************************************************************************************************************
changed: [node71.lab.local]

TASK [Enable br_netfilter (probably not survive the reboot!!! - check in the future)] *************************************************************************
changed: [node71.lab.local]

TASK [Copy kubernetes repo definition to yum dir] *************************************************************************************************************
changed: [node71.lab.local]

TASK [Install kubeadm, docker and wget] ***********************************************************************************************************************
 [WARNING]: Consider using the yum module rather than running 'yum'.  If you need to use command because yum is insufficient you can add 'warn: false' to this
command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [node71.lab.local]

TASK [Enable docker] ******************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Enable kubelet] *****************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Run kubeadm] ********************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Get token] **********************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Get CA sha256] ******************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Create Token file] **************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Create .kube directory] *********************************************************************************************************************************
 [WARNING]: Consider using the file module with state=directory rather than running 'mkdir'.  If you need to use command because file is insufficient you can
add 'warn: false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [node71.lab.local]

TASK [Copy cfg to .kube dir] **********************************************************************************************************************************
changed: [node71.lab.local]

TASK [Change ownership to kube directory] *********************************************************************************************************************
 [WARNING]: Consider using the file module with owner rather than running 'chown'.  If you need to use command because file is insufficient you can add 'warn:
false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [node71.lab.local]

TASK [Get calico manifest] ************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Change pod ip] ******************************************************************************************************************************************
changed: [node71.lab.local]

TASK [Apply Calico SDN Manifest] ******************************************************************************************************************************
changed: [node71.lab.local]

PLAY RECAP ****************************************************************************************************************************************************
localhost                  : ok=6    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
node71.lab.local           : ok=25   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Creating nodes...
node81.lab.local
centos7 (10.1.16.200) at 52:54:00:19:85:1d [ether] on virbr16
 [WARNING]: Could not match supplied host pattern, ignoring: newhost


PLAY [localhost] **********************************************************************************************************************************************

TASK [Set global variables] ***********************************************************************************************************************************
ok: [localhost]

TASK [Set ip] *************************************************************************************************************************************************
ok: [localhost]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [localhost]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [localhost]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [localhost]

TASK [Create ansible group for new hosts] *********************************************************************************************************************
changed: [localhost]

TASK [Delete ssh keys for template] ***************************************************************************************************************************
 [WARNING]: Consider using the replace, lineinfile or template module rather than running 'sed'.  If you need to use command because replace, lineinfile or
template is insufficient you can add 'warn: false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [localhost]

TASK [Delete ssh keys for ip] *********************************************************************************************************************************
changed: [localhost]

TASK [Create ansible group for ipa server] ********************************************************************************************************************
changed: [localhost]

TASK [Create data directory] **********************************************************************************************************************************
 [WARNING]: Consider using the file module with state=directory rather than running 'mkdir'.  If you need to use command because file is insufficient you can
add 'warn: false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this message.

changed: [localhost]

TASK [Clone template] *****************************************************************************************************************************************
changed: [localhost]

TASK [Set max memory] *****************************************************************************************************************************************
changed: [localhost]

TASK [Set more memory] ****************************************************************************************************************************************
changed: [localhost]

TASK [Start machine] ******************************************************************************************************************************************
changed: [localhost]

PLAY [centos7] ************************************************************************************************************************************************

TASK [pause] **************************************************************************************************************************************************
Pausing for 25 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [centos7]

TASK [Set global variables] ***********************************************************************************************************************************
ok: [centos7]

TASK [Set ip] *************************************************************************************************************************************************
ok: [centos7]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [centos7]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [centos7]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [centos7]

TASK [Change hostname] ****************************************************************************************************************************************
fatal: [centos7]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host centos7 port 22: Connection refused", "unreachable": true}

PLAY RECAP ****************************************************************************************************************************************************
centos7                    : ok=6    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=14   changed=9    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

 [WARNING]: Could not match supplied host pattern, ignoring: newhost


PLAY [localhost] **********************************************************************************************************************************************

TASK [Set global variables] ***********************************************************************************************************************************
ok: [localhost]

TASK [Set ip] *************************************************************************************************************************************************
ok: [localhost]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [localhost]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [localhost]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [localhost]

TASK [Create ansible group for new hosts] *********************************************************************************************************************
changed: [localhost]

PLAY [newhost] ************************************************************************************************************************************************

TASK [Set global variables] ***********************************************************************************************************************************
ok: [10.1.16.81]

TASK [Set ip] *************************************************************************************************************************************************
ok: [10.1.16.81]

TASK [Set FQDN] ***********************************************************************************************************************************************
ok: [10.1.16.81]

TASK [Set REALM] **********************************************************************************************************************************************
ok: [10.1.16.81]

TASK [Set Kubernetes facts] ***********************************************************************************************************************************
ok: [10.1.16.81]

TASK [Disable SElinux] ****************************************************************************************************************************************
fatal: [10.1.16.81]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 10.1.16.81 port 22: No route to host", "unreachable": true}

PLAY RECAP ****************************************************************************************************************************************************
10.1.16.81                 : ok=5    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=6    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

